下面我将基于你现有项目的代码结构（特别参考 **Smart BIM Commander** 现有框架），
**梳理出一份真正商业化、可申请专利、可落地的 MVP 需求文档（PRD 1.0）**，并专门围绕 “图数据库（Neo4j）+ 轻量化模型 + LLM 自然语言交互” 场景重新设计你的产品价值与界面结构。

你可以直接把这份文档提交给企业 CTO、专利代理人以及研发团队使用。

---

# 🧱 **BIM 图数据库智能助手（MVP 1.0）产品需求文档**

> 目标：打造一个把 **建筑模型 3D 语义 + 空间关系 + 设备系统关系** 全部存入 **Neo4j 图数据库**，
> 并通过 **LLM + Three.js** 提供可对话操作的下一代「建筑知识图谱指挥台」。

---

# 0. Why —— 产品本质价值（商业化定位）

### ❗ 当前建筑行业的问题

* BIM 模型复杂、重、非结构化，普通人看不懂
* 空间关系、管线关系、穿越关系都藏在 Revit / IFC 中，没有统一语义
* 沟通依赖专业人员，跨部门沟通效率低
* 传统 BIM 平台查询麻烦，无法通过自然语言查询

### ✔ 我们提供的解决方案（专利亮点）

**把 BIM 变成一个可对话的「建筑语义网络」。**

* **模型轻量化**（Three.js / speckle viewer）展示
* **空间语言 → 图查询**（Cypher 自动生成）
* **对话驱动模型交互**（高可用 LLM）
* **可视化展示空间节点、设备节点及其关系**

这是行业里非常前沿的「建筑知识图谱 + 多模态空间理解」路线，非常适合专利申请。

---

# 1. 产品功能结构（MVP 范围）

## 📌 MVP 的 4 大核心模块

1. **轻量化 BIM 模型查看器（Three.js / Speckle）**

   * 支持旋转 / 缩放 / 隐藏 / 高亮
   * 支持根据查询结果高亮空间与构件
   * 支持从模型点击元素 → 查询其 Neo4j 语义

2. **Neo4j 图数据库（建筑语义图）**
   节点类型：

   * Space（房间/空间）
   * Level（楼层）
   * System（机电系统）
   * Element（构件）
   * Pipe / Duct / Cable（机电专业构件）
   * Zone（功能区）
   * Relation（穿越、连接、包含）

   关系类型：

   * `CONTAINS`（楼层 → 空间）
   * `HAS_ELEMENT`（空间 → 构件）
   * `CONNECTED_TO`
   * `PASSES_THROUGH`
   * `LOCATED_AT`

3. **LLM 对话交互模块**
   功能：

   * 自然语言转 Neo4j Cypher 查询
   * 自然语言转 Three.js 操作（高亮、隐藏、导航）
   * 综合查询（例如：路径规划、穿越关系分析）

4. **三分屏 UI 布局（可缩放/最大化/中分）**
   左侧：3D 模型
   中左：图数据库图谱（Neo4j 可视节点）
   右侧：对话窗口 + 历史任务

---

# 2. 产品 UI / UX（界面结构）

## 🎯 最关键的创新界面：**三分屏智能协作**

### **左侧（3D 模型）**

* Three.js + Speckle Viewer（参考现有的代码框架）
* 实时高亮
* 路径动画（如“去到一楼电房的路线”）

### **中间（Neo4j 图谱可视化）**

* 使用 Neo4j Bloom 或自定义 D3.js 节点图
* 展示空间关系、设备关系、贯穿关系
* 节点点击事件 → 同步高亮模型

### **右侧（LLM 对话）**

样例输入：

* “分析一下该建筑模型每层分别有哪些空间？”
* “去到一楼电房如何走？”
* “这一根管穿过哪些空间？”

LLM 输出操作：

1. 解析自然语言 → 意图/实体
2. 生成 Cypher → 查询 Neo4j
3. 把结果转换成：

   * 模型的高亮指令
   * 节点图谱的展示指令
   * 文字说明

你已经在现有项目中具备右侧对话 + 左侧模型可视化结构（**App.tsx**），新需求主要是在 UI 左侧添加图数据库展示层。

---

# 3. 关键交互示例（真实商业化场景）

## 🔍 1）空间查询

**用户：**

> 分析一下该建筑模型每层有哪些空间？

LLM 工作流：

1. NLP → 提取意图：列出楼层空间
2. Cypher：

```cypher
MATCH (l:Level)-[:CONTAINS]->(s:Space)
RETURN l.name, collect(s.name)
```

3. 前端展示：

   * 右侧：列表输出
   * 中间图谱：显示 Level → Space 关系
   * 左侧 3D：高亮这些空间

---

## 🚶 2）路径导航

**用户：**

> 去到一楼电房如何走？

LLM →

1. Cypher 查询空间几何中心
2. 使用 A* 或 NavMesh 得出路线
3. 前端 Three.js 播放路径动画

---

## 📡 3）管线穿越分析

**用户：**

> 这一根管穿过哪些空间？

LLM →

1. 解析用户点击的元素 ID
2. Cypher：

```cypher
MATCH (p:Pipe {id:$pipeId})-[:PASSES_THROUGH]->(s:Space)
RETURN s
```

3. 3D Viewer 高亮路径
4. Neo4j 图谱展示穿越关系
5. 对话框总结语义

---

# 4. 技术架构（MVP 级）

## 🔧 后端技术

* Neo4j AuraDB / 本地 Neo4j
* Python/Node.js 创建 API
* 匹配 Revit/IFC → Graph Schema 的 ETL 脚本

## 🔧 前端技术

你现有框架使用：

* React（index.tsx，App.tsx）
* Tailwind UI（Smart BIM Commander）
* Speckle Viewer（三维加载）
* Three.js（后续加入 3D 路径可视化）

新增模块：

* 图数据库可视化（Cytoscape.js / D3.js / Neo4j Bloom embed）
* LLM 解析自然语言 → Cypher + 模型命令

---

# 5. 数据模型（BIM 图谱 Schema 1.0）

```plaintext
(:Project)-[:HAS_LEVEL]->(:Level)
(:Level)-[:CONTAINS]->(:Space)
(:Space)-[:HAS_ELEMENT]->(:Element)
(:Element)-[:PART_OF_SYSTEM]->(:System)
(:Pipe)-[:PASSES_THROUGH]->(:Space)
(:Duct)-[:CONNECTED_TO]->(:Element)
```

专利点：
**把 BIM 模型语义 → 图数据库空间语言映射算法**（可单独撰写专利部分）

---

# 6. MVP 范围（必须实现 vs 可交付 vs 非必需）

### ✔ 必须实现（MVP）

* 3D 可视化（Speckle 已具备）
* Neo4j 建模（空间 + 构件 + 楼层）
* LLM → Cypher 转换
* 查询结果同步高亮模型
* 三分屏 UI（左模型 / 中图谱 / 右对话）

### ➕ 应该实现（MVP+）

* 路径规划
* 穿越关系分析
* 模型节点点击 → 图谱同步

### ⭐ 可选（专利增强版）

* 多模态理解（图像识别 + BIM 模型）
* 自动生成设备流程逻辑图
* 施工方案自动生成

---

# 7. 你下一步需要提供的信息（我来继续为你产出 PRD 2.0）

为了更完整：

### （1）请提供

**你的 BIM 图数据库 Schema（或者你计划用哪些节点/关系）**
如果没有，我可以直接帮你定义一份可申请专利级 schema。

### （2）请提供

**你希望 UI 三分屏布局长什么样（草图也可以）**

### （3）请告诉我

你希望 MVP 先支持哪三大查询能力？

* 空间分析？
* 路径导航？
* 管线穿越？
* 构件属性？
* 设备系统？

我会根据你的选择做 **交互流程图 + API 设计 + LLM Prompt 设计**。

---

# 💡 总结

你现在的项目已经有很好的基础结构（React + Speckle + 对话面板）。
这个新需求让你的产品从「轻量化 BIM 可视化」
升级为
**“图数据库驱动的智能建筑语义系统”**。

这是一个**有真实商业前景**、**技术含金量高**、**容易申请专利**的方向。

---

